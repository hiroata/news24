"use strict";(()=>{var e={};e.id=405,e.ids=[405,888,660],e.modules={7523:(e,t,s)=>{s.r(t),s.d(t,{config:()=>P,default:()=>N,getServerSideProps:()=>S,getStaticPaths:()=>k,getStaticProps:()=>y,reportWebVitals:()=>_,routeModule:()=>$,unstable_getServerProps:()=>E,unstable_getServerSideProps:()=>q,unstable_getStaticParams:()=>A,unstable_getStaticPaths:()=>C,unstable_getStaticProps:()=>L});var r={};s.r(r),s.d(r,{default:()=>Home,getStaticProps:()=>getStaticProps});var a=s(7093),n=s(5244),l=s(1323),i=s(9209),o=s.n(i),c=s(1337),d=s.n(c),u=s(997),x=s(6689),m=s(7353),h=s(1664),g=s.n(h),p=s(4933);let components_NovelCard=({novel:e})=>(0,u.jsxs)("div",{className:"border-2 border-pink-200 rounded-lg p-4 mb-6 bg-white shadow-md hover:shadow-xl transition-shadow duration-300 hover:scale-105 transform hover:border-pink-400",children:[u.jsx(g(),{href:`/novels/${e.slug}`,children:u.jsx("h2",{className:"text-xl font-bold mb-2 hover:text-pink-600 transition-colors",children:e.title})}),u.jsx("div",{className:"mb-2",children:u.jsx(m.Z,{tags:e.tags,size:"sm"})}),u.jsx("p",{className:"mb-3 text-gray-700 line-clamp-3",children:e.excerpt}),e.audioUrl&&u.jsx(p.z,{src:e.audioUrl}),u.jsx("div",{className:"mt-4 flex justify-end",children:u.jsx(g(),{href:`/novels/${e.slug}`,className:"inline-block bg-pink-500 text-white px-4 py-1 rounded hover:bg-pink-600 transition-colors text-sm font-semibold shadow",children:"続きを読む"})})]}),components_NovelList=({novels:e})=>u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>u.jsx(components_NovelCard,{novel:e},e.slug))});var f=s(4390),j=s(4628),v=s(3317),w=s(968),b=s.n(w);let delay=e=>new Promise(t=>setTimeout(t,e));async function withRetry(e,t=3,s=1e3,r=2){try{return await e()}catch(a){if(t<=0)throw a;return console.log(`API呼び出しに失敗しました。${s}ms後にリトライします... (残り ${t} 回)`),await delay(s),withRetry(e,t-1,s*r,r)}}let ApiError=class ApiError extends Error{constructor(e,t,s,r){super(s),this.name="ApiError",this.status=e,this.statusText=t,this.data=r}static async fromResponse(e){let t={},s=e.statusText;try{s=(t=await e.json()).error||t.message||e.statusText}catch(t){try{s=await e.text()}catch(e){}}return new ApiError(e.status,e.statusText,s,t)}};async function fetchWithErrorHandling(e,t={},s=3){return withRetry(async()=>{let s=await fetch(e,t);if(429===s.status){let e=s.headers.get("Retry-After"),t=e?1e3*parseInt(e,10):6e4;throw console.log(`レート制限に達しました。${t}ms後にリトライします...`),await delay(t),new ApiError(429,"Too Many Requests","レート制限に達しました")}if(!s.ok)throw await ApiError.fromResponse(s);return s},s)}async function getStaticProps(){let e=(0,j.LO)(),t=(0,j.Ys)(),s=Object.keys(t);return{props:{novels:e,tags:s,tagCounts:t}}}function Home({novels:e,tags:t,tagCounts:s}){let[r,a]=(0,x.useState)(e),[n,l]=(0,x.useState)(""),[i,o]=(0,x.useState)(v.k$),[c,d]=(0,x.useState)(null),[h,g]=(0,x.useState)(!1);(0,x.useEffect)(()=>{let e=(0,v.UO)();o(e),e!==v.k$&&fetchNovelsForLanguage(e)},[]);let fetchNovelsForLanguage=async t=>{g(!0);try{let e=await fetchWithErrorHandling(`/api/novels/list?lang=${t}`),s=await e.json();a(s)}catch(s){console.error("Failed to fetch novels for language:",t,s),a(e),alert(function(e){if(e instanceof ApiError)switch(e.status){case 401:return"認証に失敗しました。再ログインしてください。";case 403:return"この操作を行う権限がありません。";case 404:return"リクエストしたリソースが見つかりませんでした。";case 429:return"リクエストが集中しています。しばらく時間をおいて再試行してください。";case 500:case 502:case 503:return"サーバーエラーが発生しました。しばらく時間をおいて再試行してください。";default:return`エラーが発生しました: ${e.message}`}return"エラーが発生しました。時間をおいて再試行してください。"}(s))}finally{g(!1)}},p=r.filter(e=>(!c||!!e.tags.includes(c))&&(!n||e.title.toLowerCase().includes(n.toLowerCase())||e.excerpt.toLowerCase().includes(n.toLowerCase())||e.tags.some(e=>e.toLowerCase().includes(n.toLowerCase())))),handleLanguageChange=e=>{o(e),fetchNovelsForLanguage(e)};return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(b(),{children:[u.jsx("title",{children:"EroNews Generator - AIが生成する官能小説"}),u.jsx("meta",{name:"description",content:"AIが生成する官能小説をお楽しみください。"})]}),(0,u.jsxs)("main",{className:"max-w-4xl mx-auto py-8 px-4",children:[(0,u.jsxs)("header",{className:"flex flex-col md:flex-row justify-between items-center mb-8",children:[(0,u.jsxs)("div",{className:"flex items-center space-x-3 mb-4 md:mb-0",children:[u.jsx("span",{className:"text-4xl",children:"\uD83C\uDF38"}),(0,u.jsxs)("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-pink-600",children:"EroNews Generator"}),u.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"AIが生成する官能小説をお楽しみください"})]})]}),u.jsx(f.Z,{onLanguageChange:handleLanguageChange})]}),h&&u.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-75 flex items-center justify-center z-50",children:u.jsx("div",{className:"text-lg",children:"読み込み中..."})}),(0,u.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,u.jsxs)("h1",{className:"text-3xl font-bold",children:[u.jsx("span",{className:"text-pink-600",children:"Ero"}),"News Generator"]}),u.jsx(f.Z,{onLanguageChange:handleLanguageChange})]}),(0,u.jsxs)("div",{className:"mb-8",children:[(0,u.jsxs)("div",{className:"relative mb-4",children:[u.jsx("input",{type:"text",value:n,onChange:e=>l(e.target.value),placeholder:"キーワード・タグで検索",className:"border px-3 py-2 rounded-md w-full pr-10 focus:ring-2 focus:ring-pink-300 focus:border-pink-300 focus:outline-none"}),n&&u.jsx("button",{onClick:()=>l(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,u.jsxs)("div",{className:"mb-2",children:[u.jsx("h2",{className:"text-lg font-medium mb-2",children:"人気のタグ:"}),u.jsx(m.Z,{tags:t,className:c?"opacity-70":""})]}),c&&(0,u.jsxs)("div",{className:"flex items-center mt-3 bg-gray-100 rounded-md p-2",children:[u.jsx("span",{className:"mr-2",children:"フィルター:"}),u.jsx("div",{className:"flex-1",children:(0,u.jsxs)("button",{onClick:()=>d(null),className:"flex items-center bg-pink-100 text-pink-800 rounded px-2 py-1 text-sm",children:["#",c,u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})})]})]}),(0,u.jsxs)("div",{className:"mb-4 text-sm text-gray-600",children:[p.length," 件の結果"]}),p.length>0?u.jsx(components_NovelList,{novels:p}):(0,u.jsxs)("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[u.jsx("p",{className:"text-gray-500 mb-2",children:"検索結果がありません"}),u.jsx("button",{onClick:()=>{l(""),d(null)},className:"text-pink-600 hover:text-pink-800",children:"すべての作品を表示"})]})]})]})}let N=(0,l.l)(r,"default"),y=(0,l.l)(r,"getStaticProps"),k=(0,l.l)(r,"getStaticPaths"),S=(0,l.l)(r,"getServerSideProps"),P=(0,l.l)(r,"config"),_=(0,l.l)(r,"reportWebVitals"),L=(0,l.l)(r,"unstable_getStaticProps"),C=(0,l.l)(r,"unstable_getStaticPaths"),A=(0,l.l)(r,"unstable_getStaticParams"),E=(0,l.l)(r,"unstable_getServerProps"),q=(0,l.l)(r,"unstable_getServerSideProps"),$=new a.PagesRouteModule({definition:{kind:n.x.PAGES,page:"/index",pathname:"/",bundlePath:"",filename:""},components:{App:d(),Document:o()},userland:r})},4933:(e,t,s)=>{s.d(t,{z:()=>AudioPlayer});var r=s(997);s(6689);let AudioPlayer=({src:e})=>r.jsx("audio",{controls:!0,src:e,className:"w-full mt-2",children:"お使いのブラウザはaudio要素に対応していません。"})},8076:e=>{e.exports=require("gray-matter")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},997:e=>{e.exports=require("react/jsx-runtime")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")}};var t=require("../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[514,209,337,656,664,436],()=>__webpack_exec__(7523));module.exports=s})();